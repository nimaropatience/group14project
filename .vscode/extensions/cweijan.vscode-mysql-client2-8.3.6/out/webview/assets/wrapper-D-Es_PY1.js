import{__commonJSMin as e,__toESM as t}from"./chunk-CYDSZ_fb.js";import{DatabaseType as n,isMySQLFamily as r,isPGFamily as i}from"./constants-36FjBj35.js";var a=e((exports,t)=>{function n(e,t){for(var n=e.toString();n.length<t;)n=`0`+n;return n}function r(e){return n(e,2)}function i(e){var t=Math.abs(e),n=String(Math.floor(t/60)),r=String(t%60);return n=(`0`+n).slice(-2),r=(`0`+r).slice(-2),e===0?`Z`:(e<0?`+`:`-`)+n+`:`+r}function a(e,a){typeof e!=`string`&&(a=e,e=t.exports.ISO8601_FORMAT),a||=t.exports.now();var o=r(a.getDate()),s=r(a.getMonth()+1),c=r(a.getFullYear()),l=r(c.substring(2,4)),u=e.indexOf(`yyyy`)>-1?c:l,d=r(a.getHours()),f=r(a.getMinutes()),p=r(a.getSeconds()),m=n(a.getMilliseconds(),3),h=i(a.getTimezoneOffset()),g=e.replace(/dd/g,o).replace(/MM/g,s).replace(/y{1,4}/g,u).replace(/hh/g,d).replace(/mm/g,f).replace(/ss/g,p).replace(/SSS/g,m).replace(/O/g,h);return g}function o(e,t,n,r){e[`set`+(r?``:`UTC`)+t](n)}function s(e,n,r){var i=e.indexOf(`O`)<0,a=!1,s=[{pattern:/y{1,4}/,regexp:`\\d{1,4}`,fn:function(e,t){o(e,`FullYear`,t,i)}},{pattern:/MM/,regexp:`\\d{1,2}`,fn:function(e,t){o(e,`Month`,t-1,i),e.getMonth()!==t-1&&(a=!0)}},{pattern:/dd/,regexp:`\\d{1,2}`,fn:function(e,t){a&&o(e,`Month`,e.getMonth()-1,i),o(e,`Date`,t,i)}},{pattern:/hh/,regexp:`\\d{1,2}`,fn:function(e,t){o(e,`Hours`,t,i)}},{pattern:/mm/,regexp:`\\d\\d`,fn:function(e,t){o(e,`Minutes`,t,i)}},{pattern:/ss/,regexp:`\\d\\d`,fn:function(e,t){o(e,`Seconds`,t,i)}},{pattern:/SSS/,regexp:`\\d\\d\\d`,fn:function(e,t){o(e,`Milliseconds`,t,i)}},{pattern:/O/,regexp:`[+-]\\d{1,2}:?\\d{2}?|Z`,fn:function(e,t){t=t===`Z`?0:t.replace(`:`,``);var n=Math.abs(t),r=(t>0?-1:1)*(n%100+Math.floor(n/100)*60);e.setUTCMinutes(e.getUTCMinutes()+r)}}],c=s.reduce(function(e,t){return t.pattern.test(e.regexp)?(t.index=e.regexp.match(t.pattern).index,e.regexp=e.regexp.replace(t.pattern,`(`+t.regexp+`)`)):t.index=-1,e},{regexp:e,index:[]}),l=s.filter(function(e){return e.index>-1});l.sort(function(e,t){return e.index-t.index});var u=new RegExp(c.regexp),d=u.exec(n);if(d){var f=r||t.exports.now();return l.forEach(function(e,t){e.fn(f,d[t+1])}),f}throw Error(`String '`+n+`' could not be parsed as '`+e+`'`)}function c(e,t,n){if(!e)throw Error(`pattern must be supplied`);return s(e,t,n)}function l(){return new Date}t.exports=a,t.exports.asString=a,t.exports.parse=c,t.exports.now=l,t.exports.ISO8601_FORMAT=`yyyy-MM-ddThh:mm:ss.SSS`,t.exports.ISO8601_WITH_TZ_OFFSET_FORMAT=`yyyy-MM-ddThh:mm:ss.SSSO`,t.exports.DATETIME_FORMAT=`dd MM yyyy hh:mm:ss.SSS`,t.exports.ABSOLUTETIME_FORMAT=`hh:mm:ss.SSS`});const o=e=>Number.isFinite(e)?e:0;function s(e){return{days:Math.trunc(e/864e5),hours:Math.trunc(e/36e5%24),minutes:Math.trunc(e/6e4%60),seconds:Math.trunc(e/1e3%60),milliseconds:Math.trunc(e%1e3),microseconds:Math.trunc(o(e*1e3)%1e3),nanoseconds:Math.trunc(o(e*1e6)%1e3)}}function c(e){return{days:e/86400000n,hours:e/3600000n%24n,minutes:e/60000n%60n,seconds:e/1000n%60n,milliseconds:e%1000n,microseconds:0n,nanoseconds:0n}}function l(e){switch(typeof e){case`number`:if(Number.isFinite(e))return s(e);break;case`bigint`:return c(e)}throw TypeError(`Expected a finite number or bigint`)}const u=e=>e===0||e===0n,d=(e,t)=>t===1||t===1n?e:`${e}s`,f=1e-7,p=24n*60n*60n*1000n;function m(e,t){let n=typeof e==`bigint`;if(!n&&!Number.isFinite(e))throw TypeError(`Expected a finite number or bigint`);t={...t},t.colonNotation&&(t.compact=!1,t.formatSubMilliseconds=!1,t.separateMilliseconds=!1,t.verbose=!1),t.compact&&(t.unitCount=1,t.secondsDecimalDigits=0,t.millisecondsDecimalDigits=0);let r=[],i=(e,t)=>{let n=Math.floor(e*10**t+f),r=Math.round(n)/10**t;return r.toFixed(t)},a=(e,n,i,a)=>{if(!((r.length===0||!t.colonNotation)&&u(e)&&!(t.colonNotation&&i===`m`))){if(a??=String(e),t.colonNotation){let e=a.includes(`.`)?a.split(`.`)[0].length:a.length,t=r.length>0?2:1;a=`0`.repeat(Math.max(0,t-e))+a}else a+=t.verbose?` `+d(n,e):i;r.push(a)}},o=l(e),s=BigInt(o.days);if(a(s/365n,`year`,`y`),a(s%365n,`day`,`d`),a(Number(o.hours),`hour`,`h`),a(Number(o.minutes),`minute`,`m`),t.separateMilliseconds||t.formatSubMilliseconds||!t.colonNotation&&e<1e3){let e=Number(o.seconds),n=Number(o.milliseconds),r=Number(o.microseconds),i=Number(o.nanoseconds);if(a(e,`second`,`s`),t.formatSubMilliseconds)a(n,`millisecond`,`ms`),a(r,`microsecond`,`µs`),a(i,`nanosecond`,`ns`);else{let e=n+r/1e3+i/1e6,o=typeof t.millisecondsDecimalDigits==`number`?t.millisecondsDecimalDigits:0,s=e>=1?Math.round(e):Math.ceil(e),c=o?e.toFixed(o):s;a(Number.parseFloat(c),`millisecond`,`ms`,c)}}else{let r=(n?Number(e%p):e)/1e3%60,o=typeof t.secondsDecimalDigits==`number`?t.secondsDecimalDigits:1,s=i(r,o),c=t.keepDecimalsOnWholeSeconds?s:s.replace(/\.0+$/,``);a(Number.parseFloat(c),`second`,`s`,c)}if(r.length===0)return`0`+(t.verbose?` milliseconds`:`ms`);let c=t.colonNotation?`:`:` `;return typeof t.unitCount==`number`&&(r=r.slice(0,Math.max(t.unitCount,1))),r.join(c)}const h=Symbol(`isDbClientData`);function g(e){return e==null?!0:typeof e==`string`?[``,`NULL`,`undefined`].includes(e.toUpperCase()):!1}function _(e,t){if(Y(e)&&typeof t==`string`){if(/boolean/i.test(e)){if(/^true$/i.test(t))return!0;if(/^false$/i.test(t))return!1}let n=/float|double|decimal/i.test(e)||t.includes(`.`),r=n?parseFloat(t):parseInt(t);if(r!=null&&!isNaN(r))return r>2**53-1||r<-(2**53-1)?t:r}return null}function v(e){return typeof e==`string`?e.replace(/ /g,` `):e}function y(e){return typeof e==`string`?e.replace(/(^'|'$)/g,``):e}var b=t(a());function x(e){if(e==null)return null;let t=Array.isArray(e)?e:[e];return t.map(e=>e.replace(/&/g,`&amp;`).replace(/</g,`&lt;`).replace(/>/g,`&gt;`).replace(/"/g,`&quot;`).replace(/'/g,`&#039;`).replace(/ /g,`&nbsp;`).replace(/\n/g,`<span style="opacity:0.7;top:2px">⤶</span>`).replace(/\u0000/g,` `)).join(`
`)}function S(e){return e?(0,b.default)(`yyyy-MM-dd hh:mm:ss`,e):``}function C(e){return e?b.default.parse(`yyyy-MM-dd hh:mm:ss`,e):null}function w(e){return isNaN(e)?`0`:m(e)}function T(e){var t;return!(!e||!(e==null||(t=e.match)==null)&&t.call(e,/(NO|0|false)/i))}function E(e){return/blob|bytea|raw|binary/i.test(e)}function D(e){return/geometry|point|linestring|polygon|multipoint|multilinestring|multipolygon|geometrycollection/i.test(e)}function O(e){return/char|text|blob|string/i.test(e)}function k(e){return typeof e==`string`&&e?.match(/^\s*[\{\[]/)}function A(e){return e==null?e=0:typeof e!=`number`&&(e=parseInt(e),isNaN(e)&&(e=0)),e}var j=class{isSupport(e){return E(e)}convert(e,t,r){if(t.startsWith(`0x`)){let e=t.slice(2);switch(r){case n.PG:return`'\\x${e}'`;case n.REDSHIFT:return`from_hex('${e}')`;case n.libSQL:case n.SQLITE:case n.DUCK_DB:return`x'${e}'`;case n.SNOWFLAKE:return`TO_BINARY('${e}', 'hex')`}return t}else switch(r){case n.DB2:return`CAST('${t}' AS BLOB)`;case n.SQLServer:return`CAST('${t}' AS varbinary)`;case n.DM:case n.ORACLE:return`rawtohex('${t}')`;case n.CASSANDRA:return`textAsBlob('${t}')`}}},M=class{isSupport(e){return e.match(/DATE/i)!=null}convert(e,t,r){switch(r){case n.TRINO:return`from_iso8601_timestamp('${t}')`;case n.ORACLE:return`TO_DATE('${t}','yyyy/mm/dd hh24:mi:ss')`}}},N=class{isSupport(e,t,r){return r==n.ORACLE&&e.match(/TIMESTAMP/i)!=null}convert(e,t,n){return`TO_TIMESTAMP('${t}','yyyy/mm/dd hh24:mi:ss')`}},P=class{isSupport(e,t,r){return[n.ES,n.MONGO_DB].includes(r)}convert(e,t,n){return _(e,t)??t}},F=class{isSupport(e,t,n){return!0}convert(e,t,n){typeof t==`string`&&(t=t.replace(/'/g,`''`));let i=`'${t}'`;return r(n)?i.replace(/\\/g,`\\\\`):i}},I=class{isSupport(e,t,n){return Y(e)}convert(e,t,n){return _(e,t)}},L=class{isSupport(e,t,n){return/bit/i.test(e)}convert(e,t,a){return r(a)?`b'${t}'`:i(a)?`B'${t}'`:a==n.SQLServer&&typeof t==`string`&&t?.match(/true|false/i)?`'${t}'`:t}},R=class{isSupport(e,t,n){return/^(bool|boolean)$/i.test(e)&&/true|false/i.test(t)}convert(e,t,n){return t}},z=class{isSupport(e){return!0}convert(e,t,r){switch(r){case n.CASSANDRA:if(e?.match(/uuid/i))return t;break;case n.PG:case n.REDSHIFT:if(t.includes(`nextval(`))return t;break;case n.SQLServer:if(O(e))return`N'${t.replace(/'/g,`''`)}'`;break;case n.TRINO:if(e?.match(/json/i))return`json_parse('${t.replace(/'/g,`''`).replace(/ /g,` `).replace(/\\/g,`\\\\`)}')`;break}}},B=class{isSupport(e,t,n){return r(n)&&D(e)}convert(e,t,n){if(t.match(/\w+\(/))return`ST_GeomFromText('${t}')`}};const V=[new P,new L,new I,new R,new j,new M,new N,new B,new z,new F];function H(e,t,n){e||=``,t=`${t}`;for(let r of V)if(r.isSupport(e,t,n)){let i=r.convert(e,t,n);if(i!=null)return i}}const U=new Set(`ACCOUNT.ACTION.ALL.ANY.BACKUP.BEGIN.CHARACTER.CONDITION.CURRENT.DATA.DATE.DESC.EXPLAIN.FROM.GRANT.GROUP.GROUPS.INDEX.JOIN.KEY.LENGTH.ORDER.PRIMARY.REGEXP.SIGNAL.SOURCE.SYSTEM.TABLE.TYPE.UNION.USER.VALUE.DATABASE.SCHEMA.VIEW.PROCEDURE.FUNCTION.TRIGGER.EVENT.SEQUENCE.COLUMN.DEFAULT.SET.TEMPORARY.OPEN`.split(`.`));let W=function(e){return e.True=`true`,e.False=`false`,e.Never=`never`,e.Always=`always`,e.Auto=`auto`,e}({});function G(e){return e?.includes(`.`)?e.split(`.`).map(e=>G(e)).join(`.`):e?.replace(/^[`"\[](.+?)[`"\]]$/,`$1`)}function K(e,t,r=!0){if(e==null||[`MongoDB`].includes(t)||r==W.Never||(r==1&&(r=W.Always),r==0&&(r=W.Auto),t==n.JDBC&&r==W.Auto))return e;let i=e.match(/[A-Z]/g)&&![n.SNOWFLAKE,n.ORACLE,n.DM,n.DB2,n.AS400,n.EXASOL].includes(t),a=/[~!@#$%^&*()/\s\|,.<>?"'();:+\-=\[\]{}]/;return r==W.Always||i||e.match(a)||U.has(e.toUpperCase())?(e=G(e),[n.MYSQL,n.MARIA_DB,n.DORIS,n.NEO4J,n.BIG_QUERY,n.DATABRICKS,n.TDengine].includes(t)?`\`${e}\``:`"${e}"`):e}function q(e,t,n){if(t==null||t===``&&!O(e))return`null`;typeof t==`object`&&t?.origin&&(t=t.origin),t=v(t);let r=H(e,t,n);if(r!=null)return r}function J(e,t){return Y(t)?e:`'${e}'`}function Y(e){if(!e||typeof e==`number`||e.includes(`[]`)||e==`interval`)return!1;let t=[`int`,`number`,`numeric`,`serial`,`float`,`double`,`decimal`,`real`,`bool`,`boolean`];return!e.match(/point/i)&&e.match(new RegExp(t.join(`|`),`i`))!=null}export{W as EscapedOption,x as escapeHtml,S as formatDate,w as formatTime,J as getDefault,E as isBinaryType,Y as isDbNumber,g as isEmpty,k as isJSONString,T as isTrue,C as parseDate,_ as stringToNumber,A as toIntSafe,y as trimQuote,v as trimSpace,K as wrapByDb,q as wrapValue};